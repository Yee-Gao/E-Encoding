function maxv=PKUtopoGradOutline(data,linewid)

data=double(data);
[yy,xx]=getcorr();
yy=150*yy;
xx=150*xx;

badch=[];
xx=xx(setdiff(1:length(xx),badch));
yy=yy(setdiff(1:length(yy),badch));
data=data(setdiff(1:length(data),badch));
[xi yi] = meshgrid(min(xx):max(xx), min(yy):max(yy));
try
  w = griddata(xx,yy,data,xi,yi);
catch
  xx(end+1,:)=0;
  yy(end+1,:)=0;
  w = griddata(xx,yy,data,xi,yi);
end

OutlinePoint = [1 4 58 57 63 66 82 81 98 97 101 100 53 52 43 32 31 29 18 17 9 1];
OutPointx = xx(OutlinePoint);
OutPointy = yy(OutlinePoint);

% LeftlinePoint  = [18 19 23 25 28 69 78 82];
% RightlinePoint = [31 34 38 26 27 86 77 81];
% LeftPointx  = xx(LeftlinePoint);
% LeftPointy  = yy(LeftlinePoint);
% RightPointx = xx(RightlinePoint);
% RightPointy = yy(RightlinePoint);

hold on;

plot([-60 0],[0 80],'k','linewidth',linewid)
plot([0 60],[80 0],'k','linewidth',linewid)
theta=0:pi/20:2*pi;
plot(-67+cos(theta)*10,sin(theta)*10,'k','linewidth',linewid)
plot(67+cos(theta)*10,sin(theta)*10,'k','linewidth',linewid)

% plotear
[c h] = contourf(xi, yi, w, 12, 'linestyle','none'); %line contours only map
axis off

plot(OutPointx,OutPointy,'k','linewidth',linewid);
% plot(LeftPointx,LeftPointy,'k--','linewidth',2);
% plot(RightPointx,RightPointy,'k--','linewidth',2);

maxv=max(w(:));

function [xx,yy,zz]=getcorr()
% load grad-1
% yy=lay.pos(1:end-2,1);
% xx=lay.pos(1:end-2,2);
xx=[[0.284323373055906;0.284774340274046;0.161334076808727;0.126560236363257;0.182158326115356;0.154274259152284;0.0436155954380299;0.0589116707646611;0.371634881953644;0.249132590426536;0.255982955679383;0.288446420910324;0.173361387469854;0.131904727494983;0.0444335669808092;0.0783781461266706;0.421538460729023;0.447583587052873;0.352184612252512;0.318259578342397;0.313800977980377;0.214816888562402;0.167713780074485;0.210894582802502;0.0866726220572385;0.0859252114946396;0.0101493044726130;0.0105740036914210;0.450000000000000;0.360492789162808;0.447804079991292;0.421345774735817;0.318423148974863;0.352494046293984;0.323284679013550;0.313839931379767;0.211002321475286;0.168303881707495;0.131647181474963;0.173079660684794;0.0775342430342658;0.0452011707563675;0.371377261167022;0.287426504776852;0.249132590426536;0.256170395549382;0.154274221768983;0.181338385718737;0.0579290943180955;0.0436153898298758;0.285235170453037;0.286984141948436;0.128056041915375;0.160619644547946;0.0156375032430014;-0.113338616470623;-0.174052112487404;-0.0324053030455123;-0.0504369263272892;-0.0567190155642188;-0.145553713281880;-0.149277937392165;-0.296980486415448;-0.234519831993354;-0.318147229062520;-0.375278320750991;-0.00966764556455025;-0.0336607028210075;-0.0932955161555257;-0.0911750356477463;-0.209551942864138;-0.275005024592535;-0.374822599623104;-0.225717042861283;-0.137640198108233;-0.137524889317046;-0.243450553011168;-0.243161368257607;-0.290795045472078;-0.393428069032612;-0.418847249368575;-0.418766912655247;-0.0334102347059309;-0.00905246596728136;-0.0917918974935494;-0.0933900959064427;-0.209683905915813;-0.225906638501626;-0.374757141463478;-0.275161006414947;-0.0558137353225200;-0.0509960247428714;-0.149916481552407;-0.145553650976378;-0.318280326074318;-0.229061253258266;-0.292309947660333;-0.375501449212114;0.0156699519480591;-0.0318510457673782;-0.175175536750125;-0.113202348108811]];
yy=[[-0.408393082953312;-0.328194231910671;-0.377054734190973;-0.450000000000000;-0.310736172617617;-0.241095091826685;-0.257447781188044;-0.326327145077633;-0.213174468911840;-0.202862700887676;-0.142865107130407;-0.270615237213752;-0.173739620385052;-0.104575687425883;-0.109488323984851;-0.184344619488178;-0.143919015901812;-0.0721916042280695;-0.0670210232476579;-0.140313593832278;-0.0679865586230868;0.000607783357288116;-0.0349661951021370;-0.0704052796017995;-0.0358490466051777;0.0370776353620069;0.0374994032289672;-0.0368712043515800;0.000636045194866020;0.000617832913748118;0.0730162948665137;0.145368921320578;0.141228840785952;0.0681227298228383;0.000608880622551466;0.0686399365451691;0.0708048292985848;0.0364158741010867;0.105006134719133;0.174346111988260;0.184790660720568;0.110045525735750;0.214987714273699;0.272838418555763;0.203698300316755;0.143236911691247;0.241930691255764;0.311358345244510;0.327974604688902;0.258023090718608;0.329622743559619;0.407504872847953;0.450000000000000;0.377106114072355;-0.396101023993618;-0.372777843836601;-0.398445786971323;-0.446081572854217;-0.312601523565397;-0.247086804590481;-0.202176283089329;-0.265823392723939;-0.311902443674249;-0.314182647976139;-0.225438649205953;-0.199343312542683;-0.178402550720506;-0.108061101187164;-0.0379000443853798;-0.124307738989970;-0.132338617647159;-0.101259101568620;-0.118182473368401;-0.192547542371904;-0.0427873393418358;0.0431334887958024;0.0448036019999694;-0.0439667485534467;0.000113868847850207;0.000417805520175696;0.0696126941321731;-0.0691748794864402;0.108643336841851;0.179153016298672;0.125247793427616;0.0389770886174972;0.133092781415658;0.192461880208087;0.118639562726698;0.101029012590213;0.247998057266371;0.312832227941254;0.265701590474066;0.203011928963498;0.225749837118035;0.314920184402233;0.312207315054021;0.199668230784648;0.395998531290125;0.446419803420251;0.398046481111262;0.373256878500166]];
